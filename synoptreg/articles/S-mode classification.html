<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>S-mode Classification • synoptReg</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="S-mode Classification">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">synoptReg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/S-mode%20classification.html">S-mode Classification</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>S-mode Classification</h1>
                        <h4 class="author">Marc Lemus-Canovas</h4>
            
            <h4 class="date">2020-03-21</h4>
      
      
      <div class="hidden name"><code>S-mode classification.Rmd</code></div>

    </div>

    
    
<p>La librería <code>synoptReg</code> contiene dos métodos principales de clasificación sinóptica basado en la disposición de la matriz de datos. Una de las disposiciones posibles es el S-mode.</p>
<div id="introduction-to-the-s-mode-classification-method" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction-to-the-s-mode-classification-method" class="anchor"></a>Introduction to the S-mode classification method</h1>
<p>La clasificación en S-mode es aquella en que los puntos de grid (lon-lat) son las variables y las observaciones (filas), los días. De este modo, la aplicación del PCA sobre este tipo de matriz establece las relaciones lineales entre las series temporales de todos los puntos de grid. En este sentido, los scores obtenidos en este tipo de clasificación muestran el grado de representatividad de cada día a cada una de las componentes principales. Sin embargo, los scores no nos permiten obtener directamente los circulation types (or weather types), ya que el un mismo día puede verse representado por distintas componentes principales. Por ejemplo, el día 2018/01/23 puede tener cierto grado de representación en el PC1, PC3 y PC6. Por este motivo, necesitamos usar los scores (grado de representatividad) como coordenadas en el espacio multivariante para ejecutar un método de clustering que acabe creando grupos entre aquellos días más similares entre sí. En este último paso se pueden realizar distintos clusterings. En el paquete <code>synoptReg</code> está implementado el método propuesto por <a href="https://rmets-onlinelibrary-wiley-com.sire.ub.edu/doi/abs/10.1002/joc.1103"><em>Esteban et al. (2005)</em></a>, basado en las puntuaciones extremas de los scores. Esteban et al. sugieren que los valores extremos (positivos y negativos) de cada componente principal (&gt;2 o &lt;-2) pueden ser las coordenadas multivariantes de cada centro de cluster. En este sentido, al usar los valores positivos y negativos, se desdoblan los grupos en cada componente (si para cada grupo se alcanzan estos extremes scores). Así, si retenemos 4 PCs, nuestra clasificación final podrá tener hasta 8 CT (WT).</p>
</div>
<div id="providing-a-simple-example" class="section level1">
<h1 class="hasAnchor">
<a href="#providing-a-simple-example" class="anchor"></a>Providing a simple example</h1>
<!-- (((Aixo anirà al T-mode))) -->
<!-- En este ejemplo realizaremos la lectura de un archivo `NetCDF` que contiene las variables mean sea level pressure, geopotential height a 500 hPa y temperatura a 850 hPa. Para realizar la lectura de este tipo de ficheros, `synoptReg` no dispone de una función concreta. En versiones anteriores sí que la tenía, pero actualmente existen alternativas más intuitivas y sencillas para la lectura de tal tipo de ficheros. En esta ocasión usaremos la función `ReadNetCDF` del package [`metR`](https://eliocamp.github.io/metR/index.html). -->
<p>En este ejemplo usaremos los datos préviamente descargados con la función <code>donwload_ncep</code>. Estos datos son los objetos <code>mslp</code> y <code>z500</code> cargados en el package, referentes a las variables mean sea level pressure y 500 hPa geopotential height, respectivamente. El periodo temporal de las variables atmosféricas va de 2000-01-01 a 2002-12-31. Un total de 3 años.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(synoptReg)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">#&gt; ****</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">#&gt; Welcome to synoptReg! </span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">#&gt; Using synoptReg for research publication?  Please cite it!</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">#&gt; I'm an early career researcher and every citation matters.</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt; ****</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co"># check ?download_ncep() to understand how to download reanalysis data.</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(mslp)</a>
<a class="sourceLine" id="cb1-10" title="10"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(z500)</a></code></pre></div>
<p>El primer paso antes de ejecutar la clasificación es pasar la función <code>tidy_nc</code>, ya que nos permitirá juntar las dos variables atmosféricas para ejecutar posteriormente la clasificación. Además es posible recortar el periodo temporal y la extensión geográfica. Además, tanto si especificamos algun argumento como en el caso contrario, esta función computa la anomalía de cada variable atmosférica. Tal anomalía es computada respecto el promedio mensual. Si recortamos el periodo temporal usando el argumento <code>time_subet</code>, la anomalía se calculará a partir de este último periodo.</p>
<p>En todo caso, ahora solamente vamos a agrupar nuestras variables ambientales. Para introducir más de una variable hay que usar una <code>lista</code> que contenga las variables de interés.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">vars &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tidy_nc.html">tidy_nc</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(mslp,z500), <span class="dt">name_vars =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"mslp"</span>,<span class="st">"z500"</span>))</a>
<a class="sourceLine" id="cb2-2" title="2">vars</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#&gt; # A tibble: 484,432 x 6</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt;    var     lon   lat time         value anom_value</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt;    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;date&gt;       &lt;dbl&gt;      &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt;  1 mslp  -10      60 2000-01-01 100010      -1908.</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt;  2 mslp   -7.5    60 2000-01-01 100292.     -1625.</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt;  3 mslp   -5      60 2000-01-01 100508.     -1410.</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt;  4 mslp   -2.5    60 2000-01-01 100675      -1243.</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt;  5 mslp    0      60 2000-01-01 100810      -1108.</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt;  6 mslp    2.5    60 2000-01-01 100915      -1003.</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#&gt;  7 mslp    5      60 2000-01-01 101000       -918.</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#&gt;  8 mslp    7.5    60 2000-01-01 101115       -803.</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co">#&gt;  9 mslp   10      60 2000-01-01 101260       -658.</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">#&gt; 10 mslp   12.5    60 2000-01-01 101365       -553.</span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="co">#&gt; # ... with 484,422 more rows</span></a></code></pre></div>
<p>Una vez unidas las dos variables en un mismo data.frame, podemos proceder a explorar nuestro conjunto de datos para decidir el número de componentes a retener. Para tal decisión usaremos la función <code>pca_decision</code>. Es importante especificar un número de componentes generosos ya que lo que queremos es saber que número de componentes explican la mayor parte de la varianza de nuestros datos. Además, como estamos trabajando con 2 variables que tienen unidades de medición distintas, es importante normalizar/estandarizar nuestros datos.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">info &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pca_decision.html">pca_decision</a></span>(vars,<span class="dt">ncomp =</span> <span class="dv">30</span>,<span class="dt">norm =</span> T,<span class="dt">matrix_mode =</span> <span class="st">"S-mode"</span>)</a>
<a class="sourceLine" id="cb3-2" title="2">info<span class="op">$</span>screeplot <span class="co">#scree test</span></a></code></pre></div>
<p><img src="S-mode%20classification_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">info<span class="op">$</span>summary[,<span class="dv">10</span>] <span class="co"># first 10 PCs</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">#&gt; [1] 1.786910096 0.009277071 0.943105029</span></a></code></pre></div>
<p>Después de echar un vistazo sobre el scree test, parace razonable retener 4 componentes principales, lo que serán 8 WT. Estos 4 PC explican un 82 % de la varianza explicada. Con estos datos, ya podemos realizar nuestra clasificación sinóptica de este periodo:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">cl &lt;-<span class="st"> </span><span class="kw"><a href="../reference/synoptclas.html">synoptclas</a></span>(vars,<span class="dt">ncomp =</span> <span class="dv">4</span>,<span class="dt">norm =</span> T,<span class="dt">matrix_mode =</span> <span class="st">"S-mode"</span>)</a>
<a class="sourceLine" id="cb5-2" title="2">cl <span class="co"># list object containing the classification and the classified grid</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">#&gt; $clas</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">#&gt; # A tibble: 1,096 x 2</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co">#&gt;    time          WT</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#&gt;    &lt;date&gt;     &lt;int&gt;</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">#&gt;  1 2000-01-01     4</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#&gt;  2 2000-01-02     4</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#&gt;  3 2000-01-03     4</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt;  4 2000-01-04     4</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">#&gt;  5 2000-01-05     4</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">#&gt;  6 2000-01-06     4</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="co">#&gt;  7 2000-01-07     4</span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co">#&gt;  8 2000-01-08     4</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">#&gt;  9 2000-01-09     4</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co">#&gt; 10 2000-01-10     6</span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="co">#&gt; # ... with 1,086 more rows</span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="co">#&gt; $grid_clas</span></a>
<a class="sourceLine" id="cb5-20" title="20"><span class="co">#&gt; # A tibble: 3,094 x 8</span></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="co">#&gt;    var     lon   lat time          WT mean_WT_value mean_WT_anom_va~</span></a>
<a class="sourceLine" id="cb5-22" title="22"><span class="co">#&gt;    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;date&gt;     &lt;int&gt;         &lt;dbl&gt;            &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb5-23" title="23"><span class="co">#&gt;  1 mslp  -10      60 2000-01-01     4        99430.           -2262.</span></a>
<a class="sourceLine" id="cb5-24" title="24"><span class="co">#&gt;  2 mslp   -7.5    60 2000-01-01     4        99489.           -2202.</span></a>
<a class="sourceLine" id="cb5-25" title="25"><span class="co">#&gt;  3 mslp   -5      60 2000-01-01     4        99533.           -2159.</span></a>
<a class="sourceLine" id="cb5-26" title="26"><span class="co">#&gt;  4 mslp   -2.5    60 2000-01-01     4        99574.           -2117.</span></a>
<a class="sourceLine" id="cb5-27" title="27"><span class="co">#&gt;  5 mslp    0      60 2000-01-01     4        99622.           -2069.</span></a>
<a class="sourceLine" id="cb5-28" title="28"><span class="co">#&gt;  6 mslp    2.5    60 2000-01-01     4        99668.           -2023.</span></a>
<a class="sourceLine" id="cb5-29" title="29"><span class="co">#&gt;  7 mslp    5      60 2000-01-01     4        99728.           -1964.</span></a>
<a class="sourceLine" id="cb5-30" title="30"><span class="co">#&gt;  8 mslp    7.5    60 2000-01-01     4        99827.           -1865.</span></a>
<a class="sourceLine" id="cb5-31" title="31"><span class="co">#&gt;  9 mslp   10      60 2000-01-01     4        99911.           -1781.</span></a>
<a class="sourceLine" id="cb5-32" title="32"><span class="co">#&gt; 10 mslp   12.5    60 2000-01-01     4        99908.           -1783.</span></a>
<a class="sourceLine" id="cb5-33" title="33"><span class="co">#&gt; # ... with 3,084 more rows, and 1 more variable: cv_WT_value &lt;dbl&gt;</span></a></code></pre></div>
<p>El objeto devuelto por synoptclas es una <code>lista</code> que contiene un <code>data.frame</code> con cada fecha y su correspondente WT, y otro data.frame que es un grid con el valor promedio de las variables atmosféricas para cada circulation type. Con este el último resultado podemo realizar una visualización de los patrones sinópticos:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2) </a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">#&gt; Warning: package 'ggplot2' was built under R version 3.6.3</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt; Warning: package 'dplyr' was built under R version 3.6.3</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt; Attaching package: 'dplyr'</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt;     filter, lag</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">#&gt;     intersect, setdiff, setequal, union</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(rnaturalearth)</a>
<a class="sourceLine" id="cb6-14" title="14"></a>
<a class="sourceLine" id="cb6-15" title="15">borders &lt;-<span class="st"> </span><span class="kw">ne_countries</span>(<span class="dt">continent =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"europe"</span>,<span class="st">"africa"</span>),</a>
<a class="sourceLine" id="cb6-16" title="16">                                       <span class="dt">returnclass =</span> <span class="st">"sf"</span>)</a>
<a class="sourceLine" id="cb6-17" title="17"></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="kw">ggplot</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(cl<span class="op">$</span>grid_clas, var <span class="op">==</span><span class="st"> "z500"</span>), </a>
<a class="sourceLine" id="cb6-20" title="20">              <span class="dt">mapping =</span> <span class="kw">aes</span>(lon,lat,<span class="dt">fill =</span> mean_WT_anom_value))<span class="op">+</span></a>
<a class="sourceLine" id="cb6-21" title="21"><span class="st">    </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> borders, <span class="dt">fill =</span> <span class="st">"transparent"</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb6-22" title="22"><span class="st">    </span>metR<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/metR/man/geom_contour2.html">geom_contour2</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(cl<span class="op">$</span>grid_clas,var <span class="op">==</span><span class="st"> "mslp"</span>),</a>
<a class="sourceLine" id="cb6-23" title="23">                  <span class="kw">aes</span>(<span class="dt">x=</span>lon,<span class="dt">y=</span>lat,<span class="dt">z=</span>mean_WT_value<span class="op">/</span><span class="dv">100</span>),</a>
<a class="sourceLine" id="cb6-24" title="24">                  <span class="dt">binwidth =</span> <span class="dv">4</span>, <span class="dt">color =</span> <span class="st">"black"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-25" title="25"><span class="st">    </span>metR<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/metR/man/geom_text_contour.html">geom_text_contour</a></span>(<span class="dt">data=</span> <span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(cl<span class="op">$</span>grid_clas, var <span class="op">==</span><span class="st"> "mslp"</span>),</a>
<a class="sourceLine" id="cb6-26" title="26">                      <span class="kw">aes</span>(<span class="dt">x=</span>lon,<span class="dt">y=</span>lat,<span class="dt">z=</span>mean_WT_value<span class="op">/</span><span class="dv">100</span>), </a>
<a class="sourceLine" id="cb6-27" title="27">                      <span class="dt">stroke =</span> <span class="fl">0.15</span>,<span class="dt">binwidth =</span> <span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-28" title="28"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>WT, <span class="dt">ncol =</span> <span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-29" title="29"><span class="st">    </span>metR<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/metR/man/scale_divergent.html">scale_fill_divergent</a></span>(<span class="dt">name =</span> <span class="st">"Z anomaly"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-30" title="30"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">10</span>,<span class="dv">30</span>), <span class="dt">expand =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb6-31" title="31"><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">30</span>,<span class="dv">60</span>), <span class="dt">expand =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb6-32" title="32"><span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb6-33" title="33">                       <span class="dt">axis.text =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb6-34" title="34">                       <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="S-mode%20classification_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
<div id="geoms-and-stats" class="section level1">
<h1 class="hasAnchor">
<a href="#geoms-and-stats" class="anchor"></a>Geoms and stats</h1>
<div id="geom_contour_fill" class="section level2">
<h2 class="hasAnchor">
<a href="#geom_contour_fill" class="anchor"></a>geom_contour_fill()</h2>
<p>In ggplot2, the ‘canonical’ way to get filled contours is by using <code>stat_contour()</code> with a <code>polygon</code> geom and mapping <code>fill</code> to <code>level</code> (see <a href="https://github.com/tidyverse/ggplot2/issues/1066">this</a> issue), but this has three important limitations.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction-to-the-s-mode-classification-method">Introduction to the S-mode classification method</a></li>
      <li><a href="#providing-a-simple-example">Providing a simple example</a></li>
      <li>
<a href="#geoms-and-stats">Geoms and stats</a><ul class="nav nav-pills nav-stacked">
<li><a href="#geom_contour_fill">geom_contour_fill()</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Marc Lemus-Canovas, Dominic Roye).</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
