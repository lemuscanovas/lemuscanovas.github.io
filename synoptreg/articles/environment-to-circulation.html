<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="synoptReg">
<title>Environment-To-Circulation • synoptReg</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Environment-To-Circulation">
<meta property="og:description" content="synoptReg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">synoptReg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/circulation-to-environment.html">Circulation-To-Environment</a>
    <a class="dropdown-item" href="../articles/classification_metrics.html">Extracting metrics from the synoptic classification</a>
    <a class="dropdown-item" href="../articles/environment-to-circulation.html">Environment-To-Circulation</a>
    <a class="dropdown-item" href="../articles/Lamb.html">Objective Lamb classification</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lemuscanovas/synoptReg/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Environment-To-Circulation</h1>
                        <h4 data-toc-skip class="author">Marc
Lemus-Canovas</h4>
            
            <h4 data-toc-skip class="date">2023-10-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/lemuscanovas/synoptReg/blob/HEAD/vignettes/environment-to-circulation.Rmd" class="external-link"><code>vignettes/environment-to-circulation.Rmd</code></a></small>
      <div class="d-none name"><code>environment-to-circulation.Rmd</code></div>
    </div>

    
    
<p>In this case we will develop a synoptic classification that goes from
environment to circulation. A simple example would be to study the WT
associated to daily rainfall equal or greater than 100 mm.</p>
<div class="section level2">
<h2 id="introduction-to-the-t-mode-classification-method">Introduction to the T-mode classification method<a class="anchor" aria-label="anchor" href="#introduction-to-the-t-mode-classification-method"></a>
</h2>
<p>The structure of the matrix in <code>T-mode</code> establishes that
the variables are the days, and the observations are the grid points. In
this case, the PCA establishes the linear relationships between each
daily map of the atmospheric variable in order to extract the main WT.
The PCA associates directly those days more similar to each other to
group the WTs, so it is not necessary to use any clustering method.
<code>synoptReg</code> allows to perform three variants of the
<code>T-mode</code> based on:</p>
<ol style="list-style-type: decimal">
<li><p>Positive and negative (PN) correlations (loadings) of each of the
days against each PC. Day 1 may be associated with PC X+ or PC X-,
depending on whether the correlation is positive or negative. This last
option, allows to obtain the double of classes of the selected
components. If 4 PCs are selected, the final result can reach up to a
maximum of 8 CTs.</p></li>
<li><p>Maximum positive correlations (MAX) of each day against each PC.
Day 1 will be associated with the PC with a higher
<strong>positive</strong> correlation;</p></li>
<li><p>Absolute correlations (ABS) of each day against each PC. Day 1
will be associated with the PC with a higher <strong>absolute</strong>
correlation.</p></li>
</ol>
<p>See the follwing example:</p>
<table class="table">
<thead><tr class="header">
<th>time</th>
<th>PC1</th>
<th>PC2</th>
<th>PC3</th>
<th>PN</th>
<th>MAX</th>
<th>ABS</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>2000-01-01</td>
<td>0.7</td>
<td>0.3</td>
<td>-0.4</td>
<td>1+</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>2000-01-02</td>
<td>0.5</td>
<td>0.4</td>
<td>-0.6</td>
<td>3-</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="odd">
<td>2000-01-03</td>
<td>0.2</td>
<td>0.5</td>
<td>-0.7</td>
<td>3-</td>
<td>2</td>
<td>3</td>
</tr>
<tr class="even">
<td>2000-01-04</td>
<td>-0.3</td>
<td>0.5</td>
<td>-0.4</td>
<td>2+</td>
<td>2</td>
<td>2</td>
</tr>
<tr class="odd">
<td>2000-01-05</td>
<td>-0.6</td>
<td>0.4</td>
<td>-0.1</td>
<td>1-</td>
<td>2</td>
<td>1</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
</tbody>
</table>
<p>Note, that a VARIMAX rotation is applied to the retained PCs. See <a href="articles/circulation-to-environment.html">Circulation-To-Environment
approach</a> vignette for more information about PC rotation.</p>
<p>It is recommended to review the references proposed in the section <a href="#method-references">Method references</a>.</p>
</div>
<div class="section level2">
<h2 id="extracting-the-torrential-rainfall-events-100-mm24h">Extracting the torrential rainfall events (&gt;= 100 mm/24h)<a class="anchor" aria-label="anchor" href="#extracting-the-torrential-rainfall-events-100-mm24h"></a>
</h2>
<p>In this example we will extract every day that has at least one point
of grid with a precipitation &gt;= 100 mm in the Balearic Islands. This
can easily be done with the <code>dplyr()</code> library from the
<code>tidyverese</code> <a href="https://doi.org/10.21105/joss.01686" class="external-link">(Wickham et al.,
2019)</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">synoptReg</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">pcp_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"pcp_spread.nc"</span>, package <span class="op">=</span> <span class="st">"synoptReg"</span><span class="op">)</span></span>
<span><span class="va">pcp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_nc.html">read_nc</a></span><span class="op">(</span><span class="va">pcp_file</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/as_synoptReg.html">as_synoptReg</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">torrential_dates</span> <span class="op">&lt;-</span> <span class="va">pcp</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">value</span> <span class="op">&gt;=</span> <span class="fl">100</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The result is a vector of 83 dates that reflect those days with a
precipitation &gt;= to 100 mm at any point of the Balearic Islands.</p>
</div>
<div class="section level2">
<h2 id="synoptic-classification-procedure">Synoptic classification procedure<a class="anchor" aria-label="anchor" href="#synoptic-classification-procedure"></a>
</h2>
<div class="section level3">
<h3 id="reading-netcdf-data">Reading NetCDF data<a class="anchor" aria-label="anchor" href="#reading-netcdf-data"></a>
</h3>
<p>In order to compute the synoptic classification of these 83 events we
need to read previously the amospheric data from the ERA-Interim dataset
<a href="http://dx.doi.org/10.1002/qj.828" class="external-link">(Dee et al., 2011)</a>,
stored in <code>NetCDF</code> files. To read these type of files,
<code>synoptReg</code> does not have a specific function. In previous
versions it did, but now there are more intuitive and simple
alternatives for reading it. In this case, we will use the
<code><a href="https://rdrr.io/pkg/metR/man/ReadNetCDF.html" class="external-link">ReadNetCDF()</a></code> function included in <a href="https://eliocamp.github.io/metR/index.html" class="external-link"><code>metR</code></a>.
The variables we will read are: mean sea level pressure (mslp),
geopotential height at 500 hPa (z500) and temperature at 850 hPa (t850).
Thus, our classification will be made with <strong>3 atmospheric
variables</strong> that will provide information from different layers
of the troposphere (surface and height).</p>
<p>Note that reading with <code><a href="https://rdrr.io/pkg/metR/man/ReadNetCDF.html" class="external-link">ReadNetCDF()</a></code> does not return
exactly the desired <code>data.frame</code> format. For this reason, a
simple manipulation with <code>dplyr()</code> is required:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/eliocamp/metR" class="external-link">metR</a></span><span class="op">)</span></span>
<span><span class="co"># listing NetCDF files stored in synoptReg:</span></span>
<span><span class="va">msl_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"mslp_ei.nc"</span>, package <span class="op">=</span> <span class="st">"synoptReg"</span><span class="op">)</span></span>
<span><span class="va">z500_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"z500_ei.nc"</span>, package <span class="op">=</span> <span class="st">"synoptReg"</span><span class="op">)</span></span>
<span><span class="va">t850_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"t850_ei.nc"</span>, package <span class="op">=</span> <span class="st">"synoptReg"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">msl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_nc.html">read_nc</a></span><span class="op">(</span><span class="va">msl_file</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/as_synoptReg.html">as_synoptReg</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">z500</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_nc.html">read_nc</a></span><span class="op">(</span><span class="va">z500_file</span>,anomaly <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/as_synoptReg.html">as_synoptReg</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">t850</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_nc.html">read_nc</a></span><span class="op">(</span><span class="va">t850_file</span>,anomaly <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/as_synoptReg.html">as_synoptReg</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vars_torrential</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">msl</span>,<span class="va">z500</span>, <span class="va">t850</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">torrential_dates</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="filtering-and-grouping-the-atmospheric-variables-using-the-torrential-events">Filtering and grouping the atmospheric variables using the
torrential events<a class="anchor" aria-label="anchor" href="#filtering-and-grouping-the-atmospheric-variables-using-the-torrential-events"></a>
</h3>
<p>Now, we can proceed to: 1) grouping the three atmospheric variables
in one unique <code>tibble</code>; 2) Subset the atmospheric variables
using the torrential rainfall dates. All this process can be computed by
means of <code><a href="../reference/tidy_nc.html">tidy_nc()</a></code>. A list is required to group the
atmospheric variables.</p>
<p>We already have the variables grouped and filtered. In addition,
<code><a href="../reference/tidy_nc.html">tidy_nc()</a></code> computes the anomaly of the atmospheric variables
using the monthly average of the whole study period before filtering the
dates.</p>
</div>
<div class="section level3">
<h3 id="selecting-the-number-of-pcs-and-synoptic-classification-performance">Selecting the number of PCs and Synoptic classification
performance<a class="anchor" aria-label="anchor" href="#selecting-the-number-of-pcs-and-synoptic-classification-performance"></a>
</h3>
<p>As in the case of the <a href="articles/circulation-to-environment.html">circulation-to-environment</a>
approach, it is important to take the decision on the number of
components retain in order to carry out the synoptic classification. To
help in the decision making process, <code><a href="../reference/pca_decision.html">pca_decision()</a></code> returns
a scree test, among other stats:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pca_decision.html">pca_decision</a></span><span class="op">(</span><span class="va">vars_torrential</span>,ncomp <span class="op">=</span> <span class="fl">30</span>,norm <span class="op">=</span> <span class="cn">T</span>,matrix_mode <span class="op">=</span> <span class="st">"T-mode"</span><span class="op">)</span></span>
<span><span class="va">info</span><span class="op">$</span><span class="va">screeplot</span></span></code></pre></div>
<p><img src="environment-to-circulation_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">info</span><span class="op">$</span><span class="va">summary</span></span>
<span><span class="co">#&gt;                       1         2         3          4          5          6</span></span>
<span><span class="co">#&gt; sdev          5.1185115 3.6034342 3.1823508 2.57912608 2.37691417 2.27236344</span></span>
<span><span class="co">#&gt; prop.variance 0.3156525 0.1564426 0.1220163 0.08014327 0.06806893 0.06221248</span></span>
<span><span class="co">#&gt; cum.variance  0.3156525 0.4720952 0.5941115 0.67425478 0.74232370 0.80453618</span></span>
<span><span class="co">#&gt;                        7          8          9         10         11         12</span></span>
<span><span class="co">#&gt; sdev          1.55600120 1.46252779 1.25624418 1.14552095 1.03678028 0.96519519</span></span>
<span><span class="co">#&gt; prop.variance 0.02917036 0.02577093 0.01901385 0.01580986 0.01295076 0.01122412</span></span>
<span><span class="co">#&gt; cum.variance  0.83370654 0.85947747 0.87849132 0.89430118 0.90725194 0.91847606</span></span>
<span><span class="co">#&gt;                        13          14          15          16          17</span></span>
<span><span class="co">#&gt; sdev          0.868246644 0.792538727 0.762162574 0.727480937 0.697695736</span></span>
<span><span class="co">#&gt; prop.variance 0.009082557 0.007567682 0.006998696 0.006376247 0.005864811</span></span>
<span><span class="co">#&gt; cum.variance  0.927558617 0.935126299 0.942124996 0.948501243 0.954366054</span></span>
<span><span class="co">#&gt;                        18          19          20          21          22</span></span>
<span><span class="co">#&gt; sdev          0.565083481 0.557921056 0.517389968 0.502554709 0.465367037</span></span>
<span><span class="co">#&gt; prop.variance 0.003847221 0.003750312 0.003225209 0.003042906 0.002609235</span></span>
<span><span class="co">#&gt; cum.variance  0.958213275 0.961963587 0.965188796 0.968231703 0.970840938</span></span>
<span><span class="co">#&gt;                        23          24          25         26          27</span></span>
<span><span class="co">#&gt; sdev          0.405150685 0.397725264 0.389126510 0.37425815 0.367115122</span></span>
<span><span class="co">#&gt; prop.variance 0.001977676 0.001905848 0.001824331 0.00168758 0.001623777</span></span>
<span><span class="co">#&gt; cum.variance  0.972818613 0.974724461 0.976548792 0.97823637 0.979860149</span></span>
<span><span class="co">#&gt;                        28          29         30</span></span>
<span><span class="co">#&gt; sdev          0.339549481 0.334820645 0.33009835</span></span>
<span><span class="co">#&gt; prop.variance 0.001389083 0.001350661 0.00131283</span></span>
<span><span class="co">#&gt; cum.variance  0.981249232 0.982599893 0.98391272</span></span></code></pre></div>
<p>By means of the <em>Scree plot</em>, it seems reasonable to retain 6
PCs. These 6 PCs explain the 80% of the variance. With this information,
we can already perform our synoptic classification, specifying that the
matrix mode will be <code>"T-mode"</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/synoptclas.html">synoptclas</a></span><span class="op">(</span><span class="va">vars_torrential</span>,ncomp <span class="op">=</span> <span class="fl">6</span>,norm <span class="op">=</span> <span class="cn">T</span>,matrix_mode <span class="op">=</span> <span class="st">"T-mode"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if</span></span>
<span><span class="co">#&gt; `.name_repair` is omitted as of tibble 2.0.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using compatibility `.name_repair`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">synoptReg</span> package.</span></span>
<span><span class="co">#&gt;   Please report the issue at</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/lemuscanovas/synoptReg/issues&gt;</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="va">cl</span> <span class="co"># list object containing the classification and the classified grid</span></span>
<span><span class="co">#&gt; $clas_abs</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 83 × 2</span></span></span>
<span><span class="co">#&gt;    time          WT</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2000-09-04     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2000-10-11     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2000-10-22     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2001-02-18     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2001-07-16     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2001-09-06     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2001-11-10     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2001-11-11     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2001-11-14     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2001-11-15     2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 73 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $clas_max</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 83 × 2</span></span></span>
<span><span class="co">#&gt;    time          WT</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2000-09-04     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2000-10-11     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2000-10-22     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2001-02-18     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2001-07-16     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2001-09-06     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2001-11-10     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2001-11-11     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2001-11-14     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2001-11-15     2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 73 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $clas_pn</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 83 × 2</span></span></span>
<span><span class="co">#&gt;    time       WT   </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2000-09-04 5+   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2000-10-11 2-   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2000-10-22 3-   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2001-02-18 1-   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2001-07-16 2-   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2001-09-06 5+   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2001-11-10 2+   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2001-11-11 2+   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2001-11-14 2+   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2001-11-15 2+   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 73 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $grid_clas_abs</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,574 × 8</span></span></span>
<span><span class="co">#&gt;        x     y time       var   units    WT mean_WT_value cv_WT_value</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">15</span>      55 2000-09-04 msl   Pa        5       <span style="text-decoration: underline;">101</span>889.       1.12 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">15</span>      55 2000-10-11 msl   Pa        2       <span style="text-decoration: underline;">101</span>237.       1.53 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">15</span>      55 2000-10-22 msl   Pa        3       <span style="text-decoration: underline;">101</span>159.       1.28 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">15</span>      55 2001-02-18 msl   Pa        1       <span style="text-decoration: underline;">101</span>316.       1.40 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">15</span>      55 2002-03-29 msl   Pa        6       <span style="text-decoration: underline;">102</span>166.       0.774</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">15</span>      55 2002-09-12 msl   Pa        4       <span style="text-decoration: underline;">102</span>093.       0.725</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">12.5</span>    55 2000-09-04 msl   Pa        5       <span style="text-decoration: underline;">102</span>011.       1.01 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">12.5</span>    55 2000-10-11 msl   Pa        2       <span style="text-decoration: underline;">101</span>303.       1.61 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">12.5</span>    55 2000-10-22 msl   Pa        3       <span style="text-decoration: underline;">101</span>152.       1.33 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">12.5</span>    55 2001-02-18 msl   Pa        1       <span style="text-decoration: underline;">101</span>545.       1.35 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,564 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $grid_clas_max</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,574 × 8</span></span></span>
<span><span class="co">#&gt;        x     y time       var   units    WT mean_WT_value cv_WT_value</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">15</span>      55 2000-09-04 msl   Pa        5       <span style="text-decoration: underline;">102</span>091.       0.893</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">15</span>      55 2000-10-11 msl   Pa        1       <span style="text-decoration: underline;">100</span>961.       1.25 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">15</span>      55 2000-10-22 msl   Pa        4       <span style="text-decoration: underline;">101</span>853.       0.818</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">15</span>      55 2001-02-18 msl   Pa        2       <span style="text-decoration: underline;">102</span>242.       1.07 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">15</span>      55 2002-04-03 msl   Pa        3       <span style="text-decoration: underline;">100</span>828.       1.71 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">15</span>      55 2004-11-04 msl   Pa        6       <span style="text-decoration: underline;">100</span>588.       1.32 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">12.5</span>    55 2000-09-04 msl   Pa        5       <span style="text-decoration: underline;">102</span>140.       0.792</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">12.5</span>    55 2000-10-11 msl   Pa        1       <span style="text-decoration: underline;">100</span>942.       1.25 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">12.5</span>    55 2000-10-22 msl   Pa        4       <span style="text-decoration: underline;">101</span>965.       0.757</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">12.5</span>    55 2001-02-18 msl   Pa        2       <span style="text-decoration: underline;">102</span>432.       1.04 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,564 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $grid_clas_pn</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5,148 × 8</span></span></span>
<span><span class="co">#&gt;        x     y time       var   units WT    mean_WT_value cv_WT_value</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   -<span style="color: #BB0000;">15</span>    55 2000-09-04 msl   Pa    5+          <span style="text-decoration: underline;">102</span>523.       0.601</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   -<span style="color: #BB0000;">15</span>    55 2000-10-11 msl   Pa    2-          <span style="text-decoration: underline;">100</span>288.       1.35 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   -<span style="color: #BB0000;">15</span>    55 2000-10-22 msl   Pa    3-          <span style="text-decoration: underline;">100</span>442.       0.708</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   -<span style="color: #BB0000;">15</span>    55 2001-02-18 msl   Pa    1-          <span style="text-decoration: underline;">101</span>483.       1.72 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   -<span style="color: #BB0000;">15</span>    55 2001-11-10 msl   Pa    2+          <span style="text-decoration: underline;">102</span>398.       0.800</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   -<span style="color: #BB0000;">15</span>    55 2002-03-29 msl   Pa    6-          <span style="text-decoration: underline;">102</span>504.       0.515</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   -<span style="color: #BB0000;">15</span>    55 2002-04-03 msl   Pa    5-          <span style="text-decoration: underline;">101</span>165.       1.18 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   -<span style="color: #BB0000;">15</span>    55 2002-05-03 msl   Pa    1+          <span style="text-decoration: underline;">101</span>148.       1.08 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   -<span style="color: #BB0000;">15</span>    55 2002-09-12 msl   Pa    4+          <span style="text-decoration: underline;">102</span>214.       0.493</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   -<span style="color: #BB0000;">15</span>    55 2004-11-04 msl   Pa    6+          <span style="text-decoration: underline;">101</span>716.       0.947</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5,138 more rows</span></span></span></code></pre></div>
<p>The object returned by <code>synoptclas</code> differs relatively
from the object returned when we apply a classification in
<code>"S-mode"</code>. This time, the output is a list with 4 objects: 2
objects are <code>tibbles</code> with the variables <code>time</code>
and <code>WT</code>. The difference between the two objects lies in the
grouping method applied to achieve the WTs. In <code>clas_abs</code> the
association is done with the absolute correlations;In
<code>clas_max</code> the association is done with the positive
correlations; finally, in <code>clas_pn</code> the extreme positive and
negative values are used to get the final groups. The three remaining
objects are the grids classified with each of these methods. In this
case, we will work with the PN approach. Let’s see the results:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rnaturalearth/" class="external-link">rnaturalearth</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/eliocamp/metR" class="external-link">metR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">borders</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rnaturalearth/reference/ne_countries.html" class="external-link">ne_countries</a></span><span class="op">(</span>continent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"europe"</span>,<span class="st">"africa"</span><span class="op">)</span>,</span>
<span>                                       returnclass <span class="op">=</span> <span class="st">"sf"</span>,scale <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/metR/man/geom_contour_fill.html" class="external-link">geom_contour_fill</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cl</span><span class="op">$</span><span class="va">grid_clas_pn</span>, <span class="va">var</span> <span class="op">==</span> <span class="st">"z"</span><span class="op">)</span>, </span>
<span>              mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,z <span class="op">=</span> <span class="va">mean_WT_value</span><span class="op">/</span><span class="fl">9.8</span><span class="op">)</span>, <span class="co"># to m</span></span>
<span>              binwidth <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">borders</span>, fill <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/metR/man/geom_contour2.html" class="external-link">geom_contour2</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cl</span><span class="op">$</span><span class="va">grid_clas_pn</span>,<span class="va">var</span> <span class="op">==</span> <span class="st">"msl"</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,z<span class="op">=</span><span class="va">mean_WT_value</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span>, </span>
<span>                binwidth <span class="op">=</span> <span class="fl">4</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/metR/man/geom_text_contour.html" class="external-link">geom_text_contour</a></span><span class="op">(</span>data<span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cl</span><span class="op">$</span><span class="va">grid_clas_pn</span>, <span class="va">var</span> <span class="op">==</span> <span class="st">"msl"</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,z<span class="op">=</span><span class="va">mean_WT_value</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span>, </span>
<span>                    stroke <span class="op">=</span> <span class="fl">0.15</span>,binwidth <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/metR/man/geom_contour2.html" class="external-link">geom_contour2</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cl</span><span class="op">$</span><span class="va">grid_clas_pn</span>,<span class="va">var</span> <span class="op">==</span> <span class="st">"t"</span><span class="op">)</span>, </span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,z<span class="op">=</span><span class="va">mean_WT_value</span><span class="op">-</span><span class="fl">273.15</span><span class="op">)</span>, </span>
<span>                binwidth <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/metR/man/geom_text_contour.html" class="external-link">geom_text_contour</a></span><span class="op">(</span>data<span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cl</span><span class="op">$</span><span class="va">grid_clas_pn</span>, <span class="va">var</span> <span class="op">==</span> <span class="st">"t"</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,z<span class="op">=</span><span class="va">mean_WT_value</span><span class="op">)</span>, </span>
<span>                    stroke <span class="op">=</span> <span class="fl">0.15</span>,binwidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html" class="external-link">guide_colourbar</a></span><span class="op">(</span>barwidth <span class="op">=</span> <span class="fl">9</span>, barheight <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">WT</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/metR/man/scale_divergent.html" class="external-link">scale_fill_divergent</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Z anomaly (m)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>,<span class="fl">15</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">55</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>      panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>      strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"transparent"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>      axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="environment-to-circulation_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="analysing-the-spatial-contribution-of-each-wt-to-torrential-rainfall-in-the-balearic-islands">Analysing the spatial contribution of each WT to torrential rainfall
in the Balearic Islands<a class="anchor" aria-label="anchor" href="#analysing-the-spatial-contribution-of-each-wt-to-torrential-rainfall-in-the-balearic-islands"></a>
</h2>
<p>We can then calculate the maximum precipitation associated with these
CT/WT. To do this we will use the function <code><a href="../reference/ct2env.html">ct2env()</a></code>
indicating in the argument <code>fun</code> the function
<code>max</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcp_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"pcp_spread.nc"</span>, package <span class="op">=</span> <span class="st">"synoptReg"</span><span class="op">)</span></span>
<span><span class="va">pcp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_nc.html">read_nc</a></span><span class="op">(</span><span class="va">pcp_file</span><span class="op">)</span></span>
<span><span class="va">max_torrential_pcp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ct2env.html">ct2env</a></span><span class="op">(</span><span class="va">pcp</span>,clas <span class="op">=</span> <span class="va">cl</span><span class="op">$</span><span class="va">clas_pn</span>,fun <span class="op">=</span> <span class="va">max</span>,out <span class="op">=</span> <span class="st">"data.frame"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">max_torrential_pcp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>,fill<span class="op">=</span><span class="va">tp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu">pals</span><span class="fu">::</span><span class="fu"><a href="https://kwstat.github.io/pals/reference/niccoli.html" class="external-link">linearl</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  name <span class="op">=</span> <span class="st">"rainfall (mm/day)"</span>,na.value<span class="op">=</span><span class="st">"transparent"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_colour_gradient</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="st">'none'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">WT</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html" class="external-link">guide_colourbar</a></span><span class="op">(</span>barwidth <span class="op">=</span> <span class="fl">9</span>, barheight <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                     axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                     axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                     legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="environment-to-circulation_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>In addition, we can assess the spatial variability of this torrential
events by creating the function of the coefficient of variation (cv) in
the <code>fun</code> argument:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv_torrential_pcp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ct2env.html">ct2env</a></span><span class="op">(</span><span class="va">pcp</span>,</span>
<span>                            clas <span class="op">=</span> <span class="va">cl</span><span class="op">$</span><span class="va">clas_pn</span>,</span>
<span>                            fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">}</span>,</span>
<span>                            out <span class="op">=</span> <span class="st">"data.frame"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">cv_torrential_pcp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>,fill<span class="op">=</span><span class="va">tp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu">pals</span><span class="fu">::</span><span class="fu"><a href="https://kwstat.github.io/pals/reference/continuous.html" class="external-link">jet</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, </span>
<span>  name <span class="op">=</span> <span class="st">"coeff. var (%)"</span>,na.value<span class="op">=</span><span class="st">"transparent"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_colour_gradient</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="st">'none'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">WT</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html" class="external-link">guide_colourbar</a></span><span class="op">(</span>barwidth <span class="op">=</span> <span class="fl">9</span>, barheight <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                     axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                     axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                     legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="environment-to-circulation_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="method-references">Method references<a class="anchor" aria-label="anchor" href="#method-references"></a>
</h2>
<p><strong>Synoptic classification method</strong>:</p>
<p>For absolute maximum correlation/loadings approach:</p>
<ul>
<li>Lopez-Bustins, J.A., Martin-Vide, J., Sanchez-Lorenzo, A., 2008.
Iberia winter rainfall trends based upon changes in teleconnection and
circulation patterns. Glob. Planet. Change. <a href="https://doi.org/10.1016/j.gloplacha.2007.09.002" class="external-link uri">https://doi.org/10.1016/j.gloplacha.2007.09.002</a>
</li>
</ul>
<p>For maximum positive-negative loadings approach:</p>
<ul>
<li>Martin-Vide, J., Sanchez-Lorenzo, A., Lopez-Bustins, J.A.,
Cordobilla, M.J., Garcia-Manuel, A., Raso, J.M., 2008. Torrential
rainfall in northeast of the Iberian Peninsula: synoptic patterns and
WeMO influence. Adv. Sci. Res. 2, 99–105. <a href="https://doi.org/10.5194/asr-2-99-2008" class="external-link uri">https://doi.org/10.5194/asr-2-99-2008</a>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Marc Lemus-Canovas.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
