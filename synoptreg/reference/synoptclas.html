<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>PCA Synoptic classification — synoptclas • synoptReg</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="PCA Synoptic classification — synoptclas" />
<meta property="og:description" content="synoptclas allows to perform several types of synoptic classification approaches based on one or several atmospheric variables (i.e. mean sea level pressure, geoptential height at 500 hPa, etc.)" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">synoptReg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/circulation-to-environment.html">Circulation-To-Environment</a>
    </li>
    <li>
      <a href="../articles/classification_metrics.html">Extracting metrics from the synoptic classification</a>
    </li>
    <li>
      <a href="../articles/environment-to-circulation.html">Environment-To-Circulation</a>
    </li>
    <li>
      <a href="../articles/Lamb.html">Objective Lamb classification</a>
    </li>
    <li>
      <a href="../articles/SOM.html">Self-Organizing Maps</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lemuscanovas/synoptReg/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>PCA Synoptic classification</h1>
    <small class="dont-index">Source: <a href='https://github.com/lemuscanovas/synoptReg/blob/master/R/synoptclas.R'><code>R/synoptclas.R</code></a></small>
    <div class="hidden name"><code>synoptclas.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>synoptclas</code> allows to perform several types of synoptic classification approaches based on one or several atmospheric variables (i.e. mean sea level pressure, geoptential height at 500 hPa, etc.)</p>
    </div>

    <pre class="usage"><span class='fu'>synoptclas</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>ncomp</span>, norm <span class='op'>=</span> <span class='cn'>T</span>, matrix_mode <span class='op'>=</span> <span class='st'>"S-mode"</span>, extreme_scores <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>data.frame. A data.frame with the following variables: <code>lon, lat, time, value, anom_value</code>. See <code>tidy_nc</code>.</p></td>
    </tr>
    <tr>
      <th>ncomp</th>
      <td><p>Integer. Number of components to be retained.</p></td>
    </tr>
    <tr>
      <th>norm</th>
      <td><p>logical. Default <code>TRUE</code>. <code>norm = TRUE</code> is recommended for classifying two ore more variables.</p></td>
    </tr>
    <tr>
      <th>matrix_mode</th>
      <td><p>character. The mode of matrix to use. Choose between S-mode and T-mode</p></td>
    </tr>
    <tr>
      <th>extreme_scores</th>
      <td><p>Integer. Definition of extreme score threshold (Esteban et al., 2005). Default is 2. Only applicable for a <code>matrix_mode = "S-mode"</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with:</p><ul>
<li><p>A data.frame containing the dates and the weather types. If "T-mode" is selected, two classifications are returned (absolute and positive/negative classification).</p></li>
<li><p>A data frame containing the gridded data grouped by circulation types.If "T-mode" is selected, 3 classifications are returned (absolute correlation,maximum positive correlation, and positive/negative classification). In addition, p-values of a t-test computed to the anomalies, comparing them to 0 with a conf.level = 0.95, are returned</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>matrix_mode</code> argument allows to conduct different types of synoptic classifications depending on the user's objective.
If the user wants to perform a synoptic classification of a long and continuous series, he must set the <code>matrix_mode = "S-mode"</code>.
When we apply the PCA to a matrix in S-mode, the variables are the grid points (lon,lat) and the observations are the days (time series),
so the linear relationships that the PCA establishes are between the time series of the grid points. One of the results we obtain from the PCA are the "scores",
which indicate the degree of representativeness of each day for each of the principal components. However, the scores do not allow us to directly obtain the
weather types (WT) classification, since one day can be represented by several principal components. For this reason, a clustering method is required  to group each day
to an specific WT based on the multivariate coordinates provided by the "scores". Before using a clustering method, a VARIMAX rotation is performed on the principal Components
retained, with the aim of redistributing the variance of such components.
With the rotated components, the scores are used to apply the extreme scores method (Esteban et al., 2005). The scores show the degree of representativeness associated
with the variation modes of each principal component, i.e., the classification of each day to its more representative centroid. Thus, the extreme scores method uses
the scores &gt; 2 and &lt; -2, establishing a positive and negative phase for each principal component. The extreme scores procedure establishes the number of groups and their
centroids in order to apply the K-means method without iterations.
Conversely, if the user wants to perform a synoptic classification of specific events (i.e. flood events, extreme temperatures events,etc.), he must set the <code>matrix_mode = "T-mode"</code>.
In this case, the variables are the days (time series) and the observations are the grid points. The relationships established in this case are between each daily gridded map.
For this reason, the eigenvalues (correlations) allow to allow us to associate each day to a WT without using a clustering method as in the case of the S-mode matrix.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Esteban, P. , Jones, P. D., Martin.Vide, J.
<em>Atmospheric circulation patterns related to heavy snowfall days in Andorra, Pyrenees</em>
Int. J. Climatol. 25: 319-329. doi:10.1002/joc.1103</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='pca_decision.html'>pca_decision</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Load data (mslp or precp_grid)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>mslp</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>z500</span><span class='op'>)</span>
<span class='co'># Tidying our atmospheric variables (500 hPa geopotential height</span>
<span class='co'># and mean sea level pressure) together.</span>
<span class='va'>atm_data1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='tidy_nc.html'>tidy_nc</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>mslp</span>,<span class='va'>z500</span><span class='op'>)</span>,
             name_vars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mslp"</span>,<span class='st'>"z500"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># S-mode classification</span>
<span class='va'>smode_cl</span> <span class='op'>&lt;-</span> <span class='fu'>synoptclas</span><span class='op'>(</span><span class='va'>atm_data1</span>, ncomp <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span>

<span class='co'># Time subset using a vector of dates of interest</span>
<span class='va'>dates_int</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"2000-01-25"</span>,<span class='st'>"2000-04-01"</span>,<span class='st'>"2000-07-14"</span>,<span class='st'>"2001-05-08"</span>,<span class='st'>"2002-12-20"</span><span class='op'>)</span>
<span class='va'>atm_data2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='tidy_nc.html'>tidy_nc</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>mslp</span>,<span class='va'>z500</span><span class='op'>)</span>,
                     time_subset <span class='op'>=</span> <span class='va'>dates_int</span>,
                     name_vars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mslp"</span>,<span class='st'>"z500"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># T-mode classification</span>
<span class='va'>tmode_cl</span> <span class='op'>&lt;-</span> <span class='fu'>synoptclas</span><span class='op'>(</span><span class='va'>atm_data2</span>, ncomp <span class='op'>=</span> <span class='fl'>2</span>, matrix_mode <span class='op'>=</span> <span class='st'>"T-mode"</span><span class='op'>)</span>


</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Marc Lemus-Canovas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


